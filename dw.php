<?php

	require "includes.php";

	print pageHeader("dialog window list");

	$itadaki	= getIS2();
	$rom		= $itadaki->rom();

	print "<pre>";

	$dialogwindows	= array(
		0x07165B,
		0x07167E,
		0x0716CF,
		0x0716D8,
		0x0716E1,
		0x0716FF,
		0x071726,
		0x07177D,
		0x0717A4,
		0x0717CF,
		0x0717F5,
		0x071822,
		0x07185A,
		0x0718DE,
		0x0718E4,
		0x0718ED,
		0x0718F6,
		0x0718FF,
		0x071908,
		0x071911,
		0x07191A,
		0x071923,
		0x07192C,
		0x071935,
		0x07193E,
		0x071947,
		0x071950,
		0x071959,
		0x071987,
		0x0719BF,
		0x071A01,
		0x071A4D,
		0x071A71,
		0x071A96,
		0x071ABB,
		0x071ADB,
		0x071B00,
		0x071B11,
		0x071B1A,
		0x071B3E,
		0x071B44,
		0x071B4A,
		0x071B77,
		0x071B98,
		0x071BB9,
		0x071BEB,
		0x071C23,
		0x071C5B,
		0x071C89,
		0x071CB3,
		0x071CE1,
		0x071D0F,
		0x071D3A,
		0x071D55,
		0x071D70,
		0x071D7A,
		0x071DC3,
		0x071DCC,
		0x071DD5,
		0x071DDE,
		0x071DE7,
		0x071DF0,
		0x071E1C,
		0x071E7B,
		0x071E97,
		0x071F12,
		0x071F34,
		0x071F3D,
		0x071FDF,
		0x0720A2,
		0x07216E,
		0x072182,
		0x072202,
		0x07221C,
		0x072270,
		0x072288,
		0x07229D,
		0x0722B3,
		0x0722C9,
		0x0722DE,
		0x0722E7,
		0x072306,
		0x07230F,
		0x07232D,
		0x072349,
		0x072364,
		0x07236D,
		0x07237E,
		0x07238E,
		0x07239E,
		0x0723AF,
		0x0723CF,
		0x0723FC,
		0x072416,
		0x072433,
		0x072442,
		0x072451,
		0x072461,
		0x072474,
		0x072485,
		0x072496,
		0x0724A7,
		0x0724BE,
		0x0724FD,
		0x072529,
		0x07254F,
		0x0725AD,
		0x0725F9,
		0x07263D,
		0x072665,
		0x072683,
		0x0726A7,
		0x0726DC,
		0x0726FC,
		0x072719,
		0x072745,
		0x072785,
		0x0727AB,
		0x0727CC,
		0x0727ED,
		0x07281B,
		0x07283D,
		0x07285E,
		0x0728AA,
		0x0729F4,
		0x0729FD,
		0x072A06,
		0x072A0F,
		0x072A18,
		0x072A21,
		0x072A2A,
		0x072A66,
		0x072AAB,
		0x072AE4,
		0x072AED,
		0x072AF6,
		0x072AFF,
		0x072B08,
		0x072B11,
		0x072B1A,
		0x072B23,
		0x072B2C,
		0x072B35,
		0x072B3E,
		0x072B47,
		0x072B69,
		0x072B89,
		0x072B92,
		0x072B9B,
		0x072C24,
		0x072CA6,
		0x072D24,
		0x072DB2,
		0x072E3C,
		0x072EBF,
		0x072F54,
		0x072FE9,
		0x07307F,
		0x073104,
		0x07318C,
		0x073213,
		0x07329B,
		0x07332B,
		0x0733B1,
		0x0733B7,
		0x0733DE,
		0x07340C,
		0x073415,
		0x07341E,
		0x073427,
		0x073430,
		0x073439,
		0x073442,
		0x07344B,
		0x073454,
		0x07345D,
		0x073466,
		0x073473,
		0x07349E,
		0x0734B8,
		0x0734C5,
		0x0734CE,
		0x0734D7,
		0x0734E0,
		0x0734E9,
		0x0734F2,
		0x073518,
		0x073521,
		0x073527,
		0x07352D,
		0x073533,
		0x07353C,
		0x073545,
		0x073588,
		0x073591,
		0x07359A,
		0x0735A3,
		0x0735AC,
		0x0735B5,
		0x0735EE,
		0x073626,
		0x07362F,
		0x07364F,
		0x073681,
		0x07368A,
		0x073693,
		0x0736BC,
		0x0736C5,
		0x0736CE,
		0x0736D7,
		0x0736F9,
		0x073702,
		0x07370F,
		0x0737BB,
		0x073867,
		0x0738A8,
		0x0738D1,
		0x073911,
		0x073942,
		0x073A29,
		0x073A59,
		0x073A90,
		0x073ABB,
		0x073AE7,
		0x073B09,
		0x073B29,
		0x073B53,
		0x073B73,
		0x073B90,
		0x073BB9,
		0x073BD7,
		0x073BEC,
		0x073C16,
		0x073C41,
		0x073C67,
		0x073CB3,
		0x073CBC,
		0x073D02,
		0x073D08,
		0x073D11,
		0x073D1A,
		0x073D66,
		0x073D94,
		0x073DBF,
		0x073DDF,
		0x073E10,
		0x073E3B,
		0x073E6C,
		0x073E8D,
		0x073EB6,
		0x073EEF,
		0x073F13,
		0x073F38,
		0x073F67,
		0x073F8B,
		0x073FBC,
		0x073FC9,
		0x073FD6,
		0x073FE3,
		0x073FF4,
		0x074013,
		0x07402B,
		0x07404A,
		0x07406D,
		0x074096,
		0x0740B6,
		0x0740D8,
		0x0740FF,
		0x074127,
		0x07414A,
		0x074176,
		0x074196,
		0x0741C1,
		0x0741D0,
		0x0741FA,
		0x074223,
		0x07424B,
		0x074269,
		0x07429A,
		0x0742CB,
		0x07430C,
		0x074340,
		0x074387,
		0x0743B9,
		0x0743E2,
		0x07441E,
		0x07443E,
		0x074447,
		0x07446B,
		0x07449D,
		0x0744C6,
		0x074501,
		0x074531,
		0x074560,
		0x074575,
		0x0745BF,
		0x0745D9,
		0x0745FD,
		0x07460C,
		0x074635,
		0x07465F,
		0x074687,
		0x0746AF,
		0x0746D5,
		0x0746F8,
		0x074726,
		0x074751,
		0x074776,
		0x07479F,
		0x0747D0,
		0x0747EC,
		0x074819,
		0x07483E,
		0x074862,
		0x074895,
		0x0748BC,
		0x0748C9,
		0x0748EE,
		0x074910,
		0x07493B,
		0x07494C,
		0x074969,
		0x074989,
		0x07499F,
		0x0749C2,
		0x0749EA,
		0x074A0C,
		0x074A32,
		0x074A4A,
		0x074A5B,
		0x074A86,
		0x074AA0,
		0x074AC6,
		0x074AD6,
		0x074AF7,
		0x074B15,
		0x074B38,
		0x074B4B,
		0x074B6A,
		0x074B7E,
		0x074B94,
		0x074BB3,
		0x074BC3,
		0x074BEA,
		0x074C08,
		0x074C27,
		0x074C4B,
		0x074C7B,
		0x074C95,
		0x074CBC,
		0x074CD3,
		0x074D01,
		0x074D1A,
		0x074D40,
		0x074D55,
		0x074D6B,
		0x074D8A,
		0x074DB6,
		0x074DE3,
		0x074E01,
		0x074E20,
		0x074E3F,
		0x074E5C,
		0x074E8D,
		0x074EBF,
		0x074EEA,
		0x074F10,
		0x074F37,
		0x074F4D,
		0x074F6A,
		0x074F96,
		0x074FC2,
		0x074FDB,
		0x075009,
		0x075030,
		0x075040,
		0x075064,
		0x075085,
		0x0750A6,
		0x0750CC,
		0x0750EF,
		0x075117,
		0x075138,
		0x07515E,
		0x07517A,
		0x07519B,
		0x0751BC,
		0x0751E3,
		0x075210,
		0x07523D,
		0x075254,
		0x07526F,
		0x07528B,
		0x0752B5,
		0x0752D3,
		0x0752FD,
		0x075313,
		0x075339,
		0x07534C,
		0x07536B,
		0x075390,
		0x0753A1,
		0x0753CC,
		0x0753F1,
		0x075418,
		0x07543D,
		0x075465,
		0x075489,
		0x0754BE,
		0x0754E7,
		0x075515,
		0x07552B,
		0x075552,
		0x07556A,
		0x07558E,
		0x07559F,
		0x0755BC,
		0x0755CC,
		0x0755DC,
		0x0755F9,
		0x07561B,
		0x07562C,
		0x07563E,
		0x075663,
		0x0756FB,
		0x07574F,
		0x075785,
		0x0757D9,
		0x07582D,
		0x075880,
		0x0758D3,
		0x075925,
		0x075969,
		0x0759C0,
		0x075A11,
		0x075A64,
		0x075A8A,
		0x075ACF,
		0x075AFB,
		0x075B3A,
		0x075B60,
		0x075B6D,
		0x075B9C,
		0x075BBD,
		0x075C09,
		0x075C40,
		0x075C5B,
		0x075C77,
		0x075C93,
		0x075CC6,
		0x075CF3,
		0x075D0E,
		0x075D2F,
		0x075DBA,
		0x075DD6,
		0x075E0A,
		0x075E37,
		0x075E65,
		0x075E94,
		0x075EC9,
		0x075EF7,
		0x075F1E,
		0x075F45,
		0x075F69,
		0x075F89,
		0x075FCF,
		0x076005,
		0x07602F,
		);

	$textboxes	= array();

	foreach ($dialogwindows as $i => $address) {
		$dpos	= ($address - 0x008000) & 0x00FFFF;
//		$jsr	= \Utils\Convert::toIntLE($matches[2][$i][0]);
		$dposc	= $address;

		$tb		= $itadaki->getTextbox($dposc);
		$tbta	= explode("\n", (string)$tb);

		$name	= sprintf("textbox_%06x", $dposc);
		if (!isset($textboxes[$name])) {
			$textboxes[$name]	= array(
				'offset'		=> $dpos,
				'offsetROM'		=> $dposc,
				'description'	=> $tbta[0],
			);
		}
//		$textboxes[$name]['references'][]	= array(
//			'referenceROM'	=> $match[1],
//			'subroutine'	=> $jsr,
//			'code'			=> bin2hex($match[0]),
//			);
//		printf("%06x : %-40s   (%04X, -&gt; %04X)   <a href='test.php?o=0x%05x'>%s</a>\n", $match[1], bin2hex($match[0]), $dpos, $jsr, $dposc, $tbta[0]);
		printf("<a href='test.php?o=0x%05x'>%s</a>\n", $dposc, $tbta[0]);
	}

	print "\n\n";

	foreach ($textboxes as $name => $textbox) {
		printf("<strong>%s - \$%06x (\$%04x): %s</strong>\n", $name, $textbox['offsetROM'], $textbox['offset'], $textbox['description']);
//		foreach ($textbox['references'] as $ref) {
//			printf("  Referenced at \$%06x, subroutine ptr \$%04x, code %s\n", $ref['referenceROM'], $ref['subroutine'], $ref['code']);
//		}
	}

	//var_dump($textboxes);
	print "</pre>";
	print pageFooter();
